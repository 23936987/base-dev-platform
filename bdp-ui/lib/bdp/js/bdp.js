var _$=BDP={};function setLocalStorage(e,t){if(!window.localStorage)return alert("浏览器不支持localstorage"),!1;window.localStorage.setItem(e,t)}function getLocalStorage(e){return window.localStorage?window.localStorage.getItem(e):(alert("浏览器不支持localstorage"),!1)}function getTopWindow(){for(var e=window;e.parent!=e&&isNotEmpty(e.parent.CC);)e=e.parent;return e}$.extend($,{bdp:BDP}),$.extend(_$,{basePath:"/lib/bdp/",parseInt:function(e){var t=parseInt(e);return isNaN(t)?0:t},parseFloat:function(e){var t=parseFloat(e);return isNaN(t)?0:t},getTarget:function(e){return e.nodeType?$(e):isString(e)?$(e):e},getFunctoin:function(e,t){return t?t[e]:window[e]},css:function(e,t){for(var r=t.toLowerCase().split(";"),n=0,i=r.length;n<i;n++){var a=r[n].split(":");if(1<a.length)if(2<a.length){var o=a[0].trim();a.removeAt(0);var s=a.join(":").trim();e.css(o,s)}else e.css(a[0].trim(),a[1].trim())}}}),$.extend(_$,{extendCommon:function(e,t,r,n){var i=e.prototype,a=null;if(t&&(a=t.prototype),null!=a)for(var o in a)i[o]=a[o];if(null!=r&&0<r.length)for(var s=0;s<r.length;s++){var l=r[s],d=l.interfaceName,u=l.prototype;if(e[d]=u)for(var v in u)i[v]=u[v]}if(n)for(var c in n)i[c]=n[c]},extend:function(){var e,t,r,n;if(e=arguments[0],t=arguments[1],3==arguments.length)n=arguments[2],r=[];else{if(4!=arguments.length)return void alert("继承方法参数不对");r=arguments[2],n=arguments[3]}var i=t.prototype;e.superclass!=i&&(e.superclass=i,e.superclass.constructor=t,_$.extendCommon(e,t,r,n))},extendLoad:function(){var t,r,n,i,a;if(t=arguments[0],r=arguments[1],3==arguments.length)a=arguments[2],i=[];else{if(4!=arguments.length)return void alert("继承方法参数不对");i=arguments[2],a=arguments[3]}if(null!=(n=_$.getClass(r))){t.prototype;var e=n.prototype;if(t.superclass==e)return;t.superclass=e,t.superclass.constructor=n,_$.extendCommon(t,n,i,a)}else{var o={};o[r]=_$.basePath+"js/"+r+".js",_$._loadCssAndJs(o,function(){var e=(n=_$.getClass(r)).prototype;t.superclass!=e&&(t.superclass=e,t.superclass.constructor=n,_$.extendCommon(t,n,i,a))})}},implements:function(){var e,t,r;if(2==arguments.length)r=arguments[1],t=[];else{if(3!=arguments.length)return void alert("继承方法参数不对");t=arguments[1],r=arguments[2]}e=arguments[0],_$.extendCommon(e,null,t,r)}}),$.extend(_$,{components:{},uids:{},classes:{},_clsPre:"cc-",_uiPreCls:"ui-",reg:function(e){if(null!==e&&e.isComponent){var t=e.id,r=e.uid,n=_$.components[t];null!=n?n.uid!=e.uid&&(delete _$.components[n.id],delete _$.uids[n.uid],_$.components[t]=e,_$.uids[r]=e):(_$.components[t]=e,_$.uids[r]=e)}},unReg:function(e){if(null!==e&&e.isComponent){var t=e.id,r=e.uid;delete _$.components[t],delete _$.uids[r]}},getById:function(e){var t=_$.components[e];return isEmpty(t)?null:t},getByUId:function(e){var t=_$.uids[e];return isEmpty(t)?null:t},regClass:function(e,t){t&&(_$.classes[e]||(t.prototype.type=e,_$.classes[e]=t))},regPlugins:function(e){_$.parser.plugins.addAll(e)},getClass:function(e){var t=_$.classes[e];return isEmpty(t)?null:t},findControls:function(e){null===e&&(e=$("body"));var t=$("[class^='"+this._uiPreCls+"']",e),n=[];return t.each(function(e){var t=$(this),r=t.attr("componentId");(t=_$.getByUId(r))&&n.add(t)}),n}}),$.extend(_$,{cssLoaded:{},jsLoaded:{},_LOADING_:"loading",_SUCCESES_:"success",_WAIT_:5,_suffix:function(e){var t=e.lastIndexOf(".");return e.substr(t+1)},getKeys:function(e){var t=[];for(var r in e)t.add(r);return t},isJsDepsLoad:function(e){var r=this;return e.every(function(e){var t=r.jsLoaded[e];return null!=t&&t!=r._LOADING_})},isCssDepsLoad:function(e){var r=this;return e.every(function(e){var t=r.cssLoaded[e];return null!=t&&t!=r._LOADING_})},_loadCssAndJs:function(u,v){var c=this,e=c.getKeys(u);if(null!=e&&0<e.length){var f=e.length,p=0;e.each(function(t){var r=u[t],e="",n=[];isString(r)?e=r:(e=r.url,n=r.deps);var i=c._suffix(e);if("js"==i){if(null==(l=c.jsLoaded[t])){function a(){c._loadJs(t,e,function(){++p==f&&v.call(window)})}if(null==n||0==n.length)a();else if(c.isJsDepsLoad(n))a();else var o=setInterval(function(){if(c.isJsDepsLoad(n)){clearInterval(o);var e={};e[t]=r,c._loadCssAndJs(e,function(){++p==f&&v.call(window)})}},c._WAIT_)}else if(null!=l&&l==c._SUCCESES_)++p==f&&v.call(window);else if(null!=l&&l==c._LOADING_)var s=setInterval(function(){c.isJsDepsLoad([t])&&(clearInterval(s),++p==f&&v.call(window))},c._WAIT_)}else if("css"==i){var l;if(null==(l=c.cssLoaded[t]))c._loadCss(t,e,function(){++p==f&&v.call(window)});else if(null!=l&&l==c._SUCCESES_)++p==f&&v.call(window);else if(null!=l&&l==c._LOADING_)var d=setInterval(function(){c.isCssDepsLoad([t])&&(clearInterval(d),++p==f&&v.call(window))},c._WAIT_)}})}else v.call(window)},_loadJs:function(e,t,r){var n=this;n.jsLoaded[e]=n._LOADING_;var i=document.createElement("script");i.setAttribute("type","text/javascript"),i.src=t,document.getElementsByTagName("head")[0].appendChild(i),i.onload=i.onreadystatechange=function(){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(n.jsLoaded[e]=n._SUCCESES_,r.call(window))}},_loadCss:function(e,t,r){var n=this;n.cssLoaded[e]=n._LOADING_;var i=document.createElement("link");i.setAttribute("type","text/css"),i.setAttribute("rel","stylesheet"),i.href=t,document.getElementsByTagName("head")[0].appendChild(i),i.onload=i.onreadystatechange=function(){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(n.cssLoaded[e]=n._SUCCESES_,r.call(window))}}}),$.extend(_$,{parser:{parseOptions:function(target,properties){var options={},s=$.trim(target.attr("data-options"));if(s&&("{"!=s.substring(0,1)&&(s="{"+s+"}"),options=new Function("return "+s)()),$.map(["width","height","minWidth","maxWidth","minHeight","maxHeight"],function(e){var t=$.trim(target[0].style[e]||"");t&&(-1==t.indexOf("%")&&(t=parseInt(t),isNaN(t)&&(t=void 0)),options[e]=t)}),properties){for(var opts={},i=0;i<properties.length;i++){var pp=properties[i];if("string"==typeof pp)opts[pp]=target.attr(pp);else for(var name in pp){var type=pp[name];if("boolean"==type&&isNotEmpty(target.attr(name))){var val=target[0].getAttribute(name);opts[name]=!!val&&"true"==val}else if("number"==type&&isNotEmpty(target.attr(name)))opts[name]="0"==target.attr(name)?0:parseFloat(target.attr(name));else if("json"==type){var s=$.trim(target.attr(name));s?("{"!=s.substring(0,1)&&(s="{"+s+"}"),options[name]=new Function("return "+s)()):options[name]={}}else if("function"==type){var s=$.trim(target.attr(name));if(isNotEmpty(s)){var func=_$.getFunctoin(s);options[name]=func}}else if("object"==type){var s=$.trim(target.attr(name));s&&(options[name]=eval("("+s+")"))}}}$.extend(options,opts)}return options},processList:{},plugins:[],getProgress:function(e){return this.processList[e]},setProgress:function(e,t){this.processList[e]=t},onComponentComplete:function(e){if(null!=e){var t=e.id,r=e.processKey,n=_$.parser.getProgress(r);null==n||n._IS_COMPLETE||(n.ids.remove(t),0===n.ids.length&&(n._IS_COMPLETE=!0,logger("***控件解析完成"),n.onComplete.call(window)))}},parse:function(){var e=$("body"),t=function(e){};1==arguments.length?isFunction(arguments[0])?t=arguments[0]:(e=arguments[0],isString(e)?e=$(e):e.nodeType&&(e=$(e))):2==arguments.length&&(e=arguments[0],t=arguments[1],isString(e)?e=$(e):e.nodeType&&(e=$(e)));var r=uuid();new _$.parser.parseComponent(r,e,t)},parseComponent:function(i,e,t){_$.parser.setProgress(i,this);var r=this;if(r._IS_COMPLETE=!1,r.count=0,r.ids=[],r.onComplete=t,!isEmpty(e)||0!=e.size()){for(var n={},a=0;a<_$.parser.plugins.length;a++){var o=_$.parser.plugins[a],s=$("."+_$._clsPre+o,e);s.each(function(e){var t=$(this).attr("id");r.count++,r.ids.add(t)}),n[o]=s}if(0===r.count)return r._IS_COMPLETE=!0,void r.onComplete.call(window,i);for(var l in n){var d=n[l];null!=d&&0!=d.size()&&d.each(function(){var t,e,r=$(this),n=_$.getClass(l);null!==n?new n(r,i):((e={})[t=l]=_$.basePath+"js/"+t+".js",_$._loadCssAndJs(e,function(){var e=setInterval(function(){(n=_$.getClass(t))&&(clearInterval(e),new n(r,i))},20)}))})}}}}}),_$.Component=function(e,t){var r=this;r.processKey=t,e=_$.getTarget(e),r.events={},r.el=e,r.uid=uuid(),r.id=e.attr("id");var n=r._attrOpts(),i=r._attrProps();r.options=$.extend(!0,n,_$.parser.parseOptions(e,i)),_$.reg(r);var a=r._require();r._getEvents.call(r,["onloadsuccess"]),_$._loadCssAndJs(a,function(){r._create()})},_$.Component.prototype={el:null,isComponent:!0,id:"",uid:"",component:null,_cls:_$._clsPre+"component",_uiCls:_$._uiPreCls+"component",_LOADING_:"loading",_LOAD_SUCCESS_:"success",_LOADING_:"loading",_LOAD_:"loading",_require:function(){return{}},getStatus:function(){return this._LOAD_},isLoaded:function(){return this._LOAD_==this._LOAD_SUCCESS_},_create:function(){},_attrProps:function(){return["id","remark","onloadsuccess",{plugins:"object"}]},_attrOpts:function(){return{onloadsuccess:function(){},plugins:{}}},_setStyle:function(){},_getEvents:function(e){var r=this;$.map(e,function(e){var t=r.getOption(e);isNotEmpty(t)&&(t=_$.getFunctoin(t),r._on(e,t))})},_loadSuccess:function(){var e=this;e.isLoaded()||(e._LOAD_=e._LOAD_SUCCESS_,_$.parser.onComponentComplete.call(_$.parser,e)),e._fire("onloadsuccess")},_loadSuccessNoEvent:function(){this.isLoaded()||(this._LOAD_=this._LOAD_SUCCESS_,_$.parser.onComponentComplete.call(_$.parser,this))},_bindEvents:function(){},_fire:function(e,t){var r=this;for(var n in e=e.toLowerCase(),r.events)if(n==e){var i=r.events[n];r._fireByEvent(i,n,t)}else if(-1!=n.indexOf(".")){if(n.split(".")[1]==e){i=r.events[n];r._fireByEvent(i,n,t)}}},_fireByEvent:function(e,t,r){var n=this;if(e){(r=r||{})&&r!=n&&(r.source=n,r.type||(r.type=t),r.name=n.name||n.name,r.id=n.id,r.name=n.id,r.source=n);for(var i=0,a=e.length;i<a;i++){var o=e[i];o&&o[0].apply(o[1],[r])}}},_on:function(e,t,r){var n=this;if("string"==typeof t){var i=_$.getFunctoin(t,r);i&&(t=i)}if("function"!=typeof t||!e)return!1;e=e.toLowerCase();var a=n.events[e];return a=a||(n.events[e]=[]),r=r||n,n._findListener(e,t,r)||(a.push([t,r]),n.events[e]=a),n},_unPrefix:function(e){for(var t in this.events){if(-1!=t.indexOf("."))t.split(".")[0]==e&&delete this.events[t]}},_un:function(e,t,r){if("function"!=typeof t)return!1;e=e.toLowerCase();var n=this.events[e];if(n){r=r||this;var i=this._findListener(e,t,r);i&&n.remove(i)}return this},_findListener:function(e,t,r){e=e.toLowerCase(),r=r||this;var n=this.events[e];if(n)for(var i=0;i<n.length;i++){var a=n[i];if(a[0]==t&&a[1]==r)return a}},_replaceNode:function(e){var t=this,r=Handlebars.compile(e)(t.options),n=$(r);t.el.replaceWith(n),t.el=n,t.el.addClass(t._uiCls),t.el.attr("componentId",t.uid)},setOption:function(e,t){this.options[e]=t},getOption:function(e){return this.options[e]},toString:function(){return this.id},destroy:function(){this.el.remove(),_$.unReg(this)}},$.extend(_$,{validator:{execute:function(e,t,r,n,i){var a=$.Deferred(),o=i.type,s=isEmpty(i.msg)?this.messages[o]:i.msg,l=i.value,d=this.methods[o],u={value:r,id:e,name:t,nameCn:n,ruleValue:l,validMsg:s};return $.when(d.call(window,u)).done(function(e){a.resolve(e)}).fail(function(e){a.reject(e)}),a.promise()},addMethod:function(e,t,r){_$.validator.methods[e]=t,_$.validator.messages[e]=r},messages:{},format:function(r,e){var t=this;return 1===arguments.length?function(){var e=$.makeArray(arguments);return e.unshift(r),t.format.apply(this,e)}:(2<arguments.length&&e.constructor!==Array&&(e=$.makeArray(arguments).slice(1)),e.constructor!==Array&&(e=[e]),$.each(e,function(e,t){r=r.replace(new RegExp("\\{"+e+"\\}","g"),function(){return t})}),r)},zeroHandler:function(e,t,r,n){var i=$.Deferred(),a=e.value,o=e.nameCn,s=e.validMsg;if(isEmpty(a)&&"required"!=n){i.resolve({state:!0,info:""})}else $.when(t.call(null,a)).done(function(e){isEmpty(r)&&(r=[o]);var t={state:e,info:_$.validator.format(s,r)};i.resolve(t)}).fail(function(e){i.reject(e)});return i.promise()},oneHandler:function(e,t){var r=e.value,n=e.nameCn,i=e.ruleValue,a=e.validMsg,o=$.Deferred();if(isEmpty(r)){o.resolve({state:!0,info:""})}else $.when(t.call(null,r,i)).done(function(e){var t=[n,i],r={state:e,info:_$.validator.format(a,t)};o.resolve(r)}).fail(function(e){o.reject(e)});return o.promise()},twoHandler:function(e,t){var r=e.value,n=e.nameCn,i=e.ruleValue,a=e.validMsg,o=$.Deferred();if(isEmpty(r)){o.resolve({state:!0,info:""})}else{var s=i.split(","),l=s[0],d=s[1];$.when(t.call(null,r,l,d)).done(function(e){var t=[n,l,d],r={state:e,info:_$.validator.format(a,t)};o.resolve(r)}).fail(function(e){o.reject(e)})}},compareTo:function(e,t,r){if(isNotEmpty(r)){var n=parseDate(e,r).getTime(),i=parseDate(t,r).getTime();return n==i?0:n<i?-1:1}return e==t?0:e<t?-1:1},methods:{}}}),_$.validator.addMethod("required",function(e){return _$.validator.zeroHandler(e,function(e){var t=$.Deferred(),r=isNotEmpty(e);return t.resolve(r),t.promise()},null,"required")},"[{0}]必填"),_$.validator.addMethod("email",function(e){return _$.validator.zeroHandler(e,function(e){var t=$.Deferred(),r=/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(e);return t.resolve(r),t.promise()})},"[{0}]必须是有效的电子邮件地址"),_$.validator.addMethod("password",function(e){return _$.validator.zeroHandler(e,function(e){var t=$.Deferred(),r=/^[A-Za-z0-9]{6,20}$/.test(e);return t.resolve(r),t.promise()})},"[{0}]必须由6-20位字母数字组成"),_$.validator.addMethod("mobile",function(e){return _$.validator.zeroHandler(e,function(e){var t=$.Deferred(),r=/^1\d{10}$/.test(e);return t.resolve(r),t.promise()})},"[{0}]必须是有效的手机号"),_$.validator.addMethod("tel",function(e){return _$.validator.zeroHandler(e,function(e){var t=$.Deferred(),r=/^0\d{2,3}-?\d{7,8}$/.test(e);return t.resolve(r),t.promise()})},"[{0}]必须是有效的座机号"),_$.validator.addMethod("url",function(e){return _$.validator.zeroHandler(e,function(e){var t=$.Deferred(),r=/^((https|http|ftp|rtsp|mms)?:\/\/)+[A-Za-z0-9]+\.[A-Za-z0-9]+[\/=\?%\-&_~`@[\]\':+!]*([^<>\"\"])*$/.test(e);return t.resolve(r),t.promise()})},"[{0}]必须是有效的网址"),_$.validator.addMethod("account",function(e){return _$.validator.zeroHandler(e,function(e){var t=$.Deferred(),r=/^[a-z0-9A-z]\w{5,9}$/.test(e);return t.resolve(r),t.promise()})},"[{0}]必须是由6-10位字母和数字组成"),_$.validator.addMethod("money",function(e){return _$.validator.zeroHandler(e,function(e){var t=$.Deferred(),r=/(^-?[1-9]([0-9]+)?(\.[0-9]{1,2})?$)|(^(0){1}$)|(^[0-9]\.[0-9]([0-9])?$)/.test(e);return t.resolve(r),t.promise()})},"[{0}]必须是有效的金钱格式"),_$.validator.addMethod("number",function(e){return _$.validator.zeroHandler(e,function(e){var t=$.Deferred(),r=/^(\-|\+)?\d+(\.\d+)?$/.test(e);return t.resolve(r),t.promise()})},"[{0}]必须是数字"),_$.validator.addMethod("integer",function(e){return _$.validator.zeroHandler(e,function(e){var t=$.Deferred(),r=/^[1-9]\d*$/.test(e);return t.resolve(r),t.promise()})},"[{0}]必须是正整数"),_$.validator.addMethod("positive",function(e){return _$.validator.zeroHandler(e,function(e){var t=$.Deferred(),r=/^-?\d+$/.test(e);return t.resolve(r),t.promise()})},"[{0}]必须是整数"),_$.validator.addMethod("natural",function(e){return _$.validator.zeroHandler(e,function(e){var t=$.Deferred(),r=/^\d+$/.test(e);return t.resolve(r),t.promise()})},"[{0}]必须是自然数"),_$.validator.addMethod("min",function(e){return _$.validator.oneHandler(e,function(e,t){var r=$.Deferred();return isNaN(e)?r.resolve(!1):t<(e=parseFloat(e))?r.resolve(!0):r.resolve(!1),r.promise()})},"[{0}]必须大于{1}"),_$.validator.addMethod("minEq",function(e){return _$.validator.oneHandler(e,function(e,t){var r=$.Deferred();return isNaN(e)?r.resolve(!1):t<=(e=parseFloat(e))?r.resolve(!0):r.resolve(!1),r.promise()})},"[{0}]必须大于等于{1}"),_$.validator.addMethod("max",function(e){return _$.validator.oneHandler(e,function(e,t){var r=$.Deferred();return isNaN(e)?r.resolve(!1):(e=parseFloat(e))<t?r.resolve(!0):r.resolve(!1),r.promise()})},"[{0}]必须小于{1}"),_$.validator.addMethod("maxEq",function(e){return _$.validator.oneHandler(e,function(e,t){var r=$.Deferred();return isNaN(e)?r.resolve(!1):(e=parseFloat(e))<=t?r.resolve(!0):r.resolve(!1),r.promise()})},"[{0}]必须小于等于{1}"),_$.validator.addMethod("minLength",function(e){return _$.validator.oneHandler(e,function(e,t){var r=$.Deferred();return(e+"").trim().length<=t?r.resolve(!1):r.resolve(!0),r.promise()})},"[{0}]必须大于{1}个字符"),_$.validator.addMethod("maxLength",function(e){return _$.validator.oneHandler(e,function(e,t){var r=$.Deferred();return(e+"").trim().length>=t?r.resolve(!1):r.resolve(!0),r.promise()})},"[{0}]必须小于{1}个字符"),_$.validator.addMethod("minLengthEq",function(e){return _$.validator.oneHandler(e,function(e,t){var r=$.Deferred();return(e+"").trim().length<t?r.resolve(!1):r.resolve(!0),r.promise()})},"[{0}]必须大于等于{1}个字符"),_$.validator.addMethod("maxLengthEq",function(e){return _$.validator.oneHandler(e,function(e,t){var r=$.Deferred();return(e+"").trim().length>t?r.resolve(!1):r.resolve(!0),r.promise()})},"[{0}]必须小于等于{1}个字符"),_$.validator.addMethod("rangeLength",function(e){return _$.validator.twoHandler(e,function(e,t,r){var n=$.Deferred(),i=(e+"").trim();return i.length<r&&i.length>t?n.resolve(!0):n.resolve(!1),n.promise()})},"[{0}]长度必须是大{1},小于{2}"),_$.validator.addMethod("rangeLengthEq",function(e){return _$.validator.twoHandler(e,function(e,t,r){var n=$.Deferred(),i=(e+"").trim();return i.length<=r&&i.length>=t?n.resolve(!0):n.resolve(!1),n.promise()})},"[{0}]长度必须是大于{1},小于等于{2}"),_$.validator.addMethod("range",function(e){return _$.validator.twoHandler(e,function(e,t,r){var n=$.Deferred();return isNaN(e)?n.resolve(!1):(e=parseFloat(e))<r&&t<e?n.resolve(!1):n.resolve(!0),n.promise()})},"[{0}]必须大于{1},小于{2}"),_$.validator.addMethod("rangeEq",function(e){return _$.validator.twoHandler(e,function(e,t,r){var n=$.Deferred();return isNaN(e)?n.resolve(!1):(e=parseFloat(e))<=r&&t<=e?n.resolve(!0):n.resolve(!1),n.promise()})},"[{0}]必须是大于等于{1},小于等于{2}"),_$.validator.addMethod("greaterEqThan",function(e){var t=e.ruleValue.split(",");if(1==t.length){var r=t[0],n=(a=_$.getById(r)).getValue(),i=[e.nameCn,a.getOption("nameCn")];return _$.validator.zeroHandler(e,function(e){var t=$.Deferred(),r=0<=_$.validator.compareTo(e,n);return t.resolve(r),t.promise()},i)}if(2==t.length){r=t[0];var a,o=t[1];n=(a=_$.getById(r)).getValue(),i=[e.nameCn,a.getOption("nameCn")];return _$.validator.zeroHandler(e,function(e){var t=$.Deferred(),r=0<=_$.validator.compareTo(e,n,o);return t.resolve(r),t.promise()},i)}},"[{0}]必须大于等于[{1}]"),_$.validator.addMethod("greaterThan",function(e){var t=e.ruleValue.split(",");if(1==t.length){var r=t[0],n=(a=_$.getById(r)).getValue(),i=[e.nameCn,a.getOption("nameCn")];return _$.validator.zeroHandler(e,function(e){var t=$.Deferred(),r=0<_$.validator.compareTo(e,n);return t.resolve(r),t.promise()},i)}if(2==t.length){r=t[0];var a,o=t[1];n=(a=_$.getById(r)).getValue(),i=[e.nameCn,a.getOption("nameCn")];return _$.validator.zeroHandler(e,function(e){var t=$.Deferred(),r=0<_$.validator.compareTo(e,n,o);return t.resolve(r),t.promise()},i)}},"[{0}]必须大于[{1}]"),_$.validator.addMethod("lessEqThan",function(e){var t=e.ruleValue.split(",");if(1==t.length){var r=t[0],n=(a=_$.getById(r)).getValue(),i=[e.nameCn,a.getOption("nameCn")];return _$.validator.zeroHandler(e,function(e){var t=$.Deferred(),r=_$.validator.compareTo(e,n)<=0;return t.resolve(r),t.promise()},i)}if(2==t.length){r=t[0];var a,o=t[1];n=(a=_$.getById(r)).getValue(),i=[e.nameCn,a.getOption("nameCn")];return _$.validator.zeroHandler(e,function(e){var t=$.Deferred(),r=_$.validator.compareTo(e,n,o)<=0;return t.resolve(r),t.promise()},i)}},"[{0}]必须小于等于[{1}]"),_$.validator.addMethod("lessThan",function(e){var t=e.ruleValue.split(",");if(1==t.length){var r=t[0],n=(a=_$.getById(r)).getValue(),i=[e.nameCn,a.getOption("nameCn")];return _$.validator.zeroHandler(e,function(e){var t=$.Deferred(),r=_$.validator.compareTo(e,n)<0;return t.resolve(r),t.promise()},i)}if(2==t.length){r=t[0];var a,o=t[1];n=(a=_$.getById(r)).getValue(),i=[e.nameCn,a.getOption("nameCn")];return _$.validator.zeroHandler(e,function(e){var t=$.Deferred(),r=_$.validator.compareTo(e,n,o)<0;return t.resolve(r),t.promise()},i)}},"[{0}]必须小于[{1}]"),_$.validator.addMethod("equalTo",function(e){var t=e.ruleValue.split(",")[0],r=_$.getById(t),n=r.getValue(),i=[e.nameCn,r.getOption("nameCn")];return _$.validator.zeroHandler(e,function(e){var t=$.Deferred(),r=0==_$.validator.compareTo(e,n);return t.resolve(r),t.promise()},i)},"[{0}]必须等于[{1}]"),_$.Form=function(e,t){e=_$.getTarget(e);this.el=e,this.formId=t;this.options=$.extend(!0,{})},_$.Form.prototype={validState:!0,clear:function(){var e=this.getFields(this.el);if(null!==e&&0<e.length)for(var t=0;t<e.length;t++){var r=e[t];r&&r.setValue(null)}},reset:function(){var e=this.getFields(this.el);if(null!==e&&0<e.length)for(var t=0;t<e.length;t++){var r=e[t];r&&r.reset()}},setValue:function(e){for(var t=this.getFields(this.el),r=0;r<t.length;r++){var n=t[r];if(null!=n){var i=n.getOption("name")||n.id;if(e.hasOwnProperty(i)){var a=e[i];n.orgiValue=a,a=n.getOption("setValueFormat").call(window,e,a,n.id),this.formId&&n.setFormData(e,this.formId),n.setValue(a)}}}},setValueNoChange:function(e,t){isEmpty(t)&&(t={});for(var r=this.getFields(this.el),n=0;n<r.length;n++){var i=r[n];if(null!=i){var a=i.getOption("name")||i.id;if(e.hasOwnProperty(a)){var o=e[a];i.orgiValue=o,o=i.getOption("setValueFormat").call(window,e,o),this.formId&&i.setFormData(e,this.formId),t[a]?i.setValue(o):i.setValue(o,!1)}}}},getValue:function(){for(var e=this.getFields(this.el),t={},r=0;r<e.length;r++){var n=e[r];if(null!==n)if(n.getOption("returnValue")){var i=n.getValue();if(isNotEmpty(i))t[n.getOption("name")||n.id]=i}}return t},getEditData:function(){for(var e=this.getFields(this.el),t={},r=0;r<e.length;r++){var n=e[r];null!==n&&n.getEditValue(t)}return t},getAddData:function(){var e={},t=this.getValue();for(var r in t){var n=t[r];isNotEmpty(n)&&(e[r]=n)}return e},getQueryData:function(){for(var e=this.getFields(this.el),t={},r=0;r<e.length;r++){var n=e[r],i=n.id;if(-1==(i+"").indexOf("_type")&&null!=n){var a=n.getValue();if(isNotEmpty(a)){t[n.getOption("name")||i]=a;var o=n.getOption("qtype"),s=(o=o||i)+"_type",l=_$.getById(s);if(null!=l){var d=l.getValue();if(isNotEmpty(d))t[l.getOption("name")]=d}}}}return t},getFields:function(){for(var e=_$.findControls(this.el),t=[],r=0;r<e.length;r++){var n=e[r];n.isFormItem&&t.add(n)}return t},setValid:function(e){this.validState=e;for(var t=this.getFields(),r=0;r<t.length;r++){t[r].setValid(e)}},isValid:function(e){var r=this,n=$.Deferred();$("#validDiv").empty(),e=e||!1,r.validState=!0;for(var t=r.getFields(),i=[],a=0;a<t.length;a++){var o=t[a];i.push(o.isValid(e))}return $.when.apply(this,i).done(function(){for(var e=0;e<arguments.length;e++){var t=arguments[e];if(r.validState&&!t){r.validState=t;break}}n.resolve(r.validState)}).fail(function(e){n.reject(e)}),n.promise()}};var _EDITABLE_=1,_SHOW_=0;_$.FormItem=function(e,t){_$.FormItem.superclass.constructor.call(this,e,t)},_$.extend(_$.FormItem,_$.Component,{isFormItem:!0,formData:{},value:null,orgiValue:null,_uiCls:_$._uiPreCls+"FormItem",_cls:_$._clsPre+"formItem",_spanCls:_$._uiPreCls+"span",validState:!0,initialization:!1,setFormData:function(e,t){this.formData[t]=e},getFormData:function(e){return this.formData[e]},errMsg:[],_create:function(){var e=this;e._isEdit()?e._editModel():e._showModel(),e.initialization=!0,e.el.attr("formId",e.id)},_editModel:function(){},getUserData:function(){return this.getOption("userData")},_showModel:function(){var e=this;e.setOption("model",_SHOW_),e._clearEdit();e._replaceNode('<div class="showDiv"></div>'),e.el.addClass(e._spanCls),e.el.addClass("FormItem"),e.component=$(".showDiv",e.el),e._bindChangeEvents(),e._init()},_clearEdit:function(){this.component&&(this.component.unbind(),this.component.remove())},_clearShow:function(){this.component&&this.component.remove()},selectText:function(e){var t=(e.val()+"").length,r=e[0];if(-1<navigator.userAgent.indexOf("MSIE")){document.selection.createRange();var n=r.createTextRange();n.moveStart("character",t),n.collapse(),n.select()}else r.setSelectionRange(0,t)},_elHeight:function(){var e=this.getOption("height");if(isNotEmpty(e)){var t=$(".form_item_valid",this.el).height()+$(".form_item_memo",this.el).height()+e;this.el.height(t)}},_setStyle:function(){var e=this.getOption("width");isNotEmpty(e)&&this.el.width(e),this._elHeight()},setWidth:function(e){isNotEmpty(e)&&this.el.width(e)},_init:function(){var e=this;if(isNotEmpty(e.value))e.setValue(e.value);else{var t=e.options.initValue;isNotEmpty(t)&&(e.setValue(t),e.orgiValue=t)}e._loadSuccess()},_attrProps:function(){var e=_$.FormItem.superclass._attrProps.call(this);return e.addAll(["name","onchange","initValue","nameCn","required-msg","qtype",{required:"boolean",immediately:"boolean",model:"number",validRules:"json",userData:"json",setValueFormat:"function",returnValue:"boolean"}]),e},_attrOpts:function(){var e=_$.FormItem.superclass._attrOpts.call(this);return $.extend(!0,e,{model:1,returnValue:!0,immediately:!1,setValueFormat:function(e,t){return t}})},_isEdit:function(){return this.options.model==_EDITABLE_},_sync:function(){this.value=this.component.val()},_validateItem:function(e){var t=this.getValue(),r=this.getOption("nameCn"),n=this.id,i=this.getOption("name");return _$.validator.execute(n,i,t,r,e)},_showErrMsg:function(){$(".form_item_valid",this.el).html(this.errMsg.join(",")),$("#validDiv").append(this.errMsg.join(",")),this._elHeight()},_replaceNode:function(e){var t=this,r='<div id="{{id}}" >'+e+'<div class="form_item_valid"></div><div class="form_item_memo">{{remark}}</div><div style="clear:both;"></div></div>';r=t._isEdit()?'<div id="{{id}}" >'+e+'<div class="form_item_valid"></div><div class="form_item_memo">{{remark}}</div><div style="clear:both;"></div></div>':'<div id="{{id}}" >'+e+"</div>";var n=Handlebars.compile(r)(t.options),i=$(n);t.el.replaceWith(i),t.el=i,t.el.addClass(t._uiCls),t.el.addClass("FormItem"),t.el.attr("componentId",t.uid)},reset:function(){this.setValue(this.orgiValue)},setValue:function(e,t){isEmpty(t)&&(t=!0);var r=this;if(isEmpty(e)?(r.value=null,r._isEdit()?r.component.val(""):r.component.html("")):(r.value=e,r._isEdit()?r.component.val(e):r.component.html(e)),t){var n={};n.value=r.value,r._fire("onchange",n)}},getValue:function(){return this.value},setValid:function(e){this.validState=e,this.validState&&(this.errMsg=[]),this._showErrMsg()},validate:function(e){var t=this,s=$.Deferred();if(isNotEmpty(e)&&0<=e.length){var r=[];e.each(function(e){r.push(t._validateItem(e))}),$.when.apply(this,r).done(function(){for(var e=!0,t=[],r=0;r<arguments.length;r++){var n=arguments[r],i=n.state,a=n.info;e&&!i&&(e=i,t.add(a))}var o={flag:e,errMsg:t};s.resolve(o)}).fail(function(e){s.reject(e)})}else setTimeout(function(){s.resolve({flag:!0,errMsg:[]})},50);return s.promise()},isValid:function(e){var r=this,n=$.Deferred();if(!r._isEdit()||!e&&!r.el.is(":visible"))return!0;var t=r.getOption("validRules"),i=r.getOption("required");if(t){var a=[];if(1==i){var o={type:"required"};o.value=t.required,o.msg=t["required-msg"],a.add(o)}for(var s in t)if(!s.endWith("msg")){var l={};l.type=s,l.value=t[s],l.msg=t[s+"-msg"],a.add(l)}$.when(r.validate(a)).done(function(e){var t=e.flag;r.errMsg=e.errMsg,r.setValid(t),n.resolve(t)}).fail(function(e){n.reject(e)})}else setTimeout(function(){n.resolve(!0)},50);return n.promise()},getEditValue:function(e){var t=this.orgiValue,r=this.getValue(),n=this.id;isEmpty(t)&&isNotEmpty(r)?e[n]=r:isNotEmpty(t)&&isEmpty(r)?e[n]=null:isNotEmpty(t)&&isNotEmpty(r)&&t!=r&&(e[n]=r)},setModel:function(e){this.options.model==_SHOW_&&e==_EDITABLE_?this._editModel():this.options.model==_EDITABLE_&&e==_SHOW_&&this._showModel()},_bindEvents:function(){this._bindChangeEvents()},_bindChangeEvents:function(){_$.FormItem.superclass._getEvents.call(this,["onchange"])},destroy:function(){this._isEdit()?this._clearEdit():this._clearShow(),_$.FormItem.superclass.destroy.call(this)}}),_$.regPlugins(["Text","TextArea"]);
//# sourceMappingURL=lib/bdp/maps/bdp.js.map
